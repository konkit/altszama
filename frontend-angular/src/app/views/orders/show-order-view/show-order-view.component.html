<ng-container *ngIf="orderResponse$ | async as orderResponse">
  <ng-container *ngIf="showOrderViewState$ | async as viewState">
    <ng-container *ngIf="modifyOrderEntryState$ | async as modifyOrderEntryState">
      <app-view-wrapper
        [title]="'[' + orderResponse.order.orderState + '] Order from ' + orderResponse.order.restaurantName + '(' + orderResponse.order.orderDate + ')'">

        <div *ngIf="shouldShowOrderLockedWarning()">
          <div>TODO order locked warning</div>
        </div>

        <div class="grid grid-cols-3">
          <div>
            <h2 class="text-2xl">Order details</h2>
            <app-order-data-summary [order]="orderResponse.order"></app-order-data-summary>
          </div>

          <div>
            <h2 class="text-2xl">Price summary</h2>
            <app-price-summary [showOrderResponse]="orderResponse"></app-price-summary>
          </div>

          <div>
            <h2 class="text-2xl">Payment options</h2>
            <app-payment-options-summary [showOrderResponse]="orderResponse"></app-payment-options-summary>
          </div>
        </div>

        <div>
          <div class="flex flex-row flex-wrap">
            <div class="mr-4 py-5">
              <b class="mr-2">See menu at &nbsp;</b>
              <a class="text-indigo-500" *ngIf="orderResponse.order.restaurantUrl" target="_blank"
                 [href]="orderResponse.order.restaurantUrl">{{ orderResponse.order.restaurantUrl }}</a>
              <i *ngIf="!orderResponse.order.restaurantUrl">Sorry, no menu url specified</i>
            </div>
            <div class="d-flex ml-auto">
              <ng-container *ngIf="viewState.canShowPlaceOrderButton && viewState.isPlaceOrderButtonDisabled">
                <app-button [disabled]="true" matTooltip="You cannot place an empty order. Choose a dish first.">
                  Place order <i class="pl-2 fa fa-arrow-right" aria-hidden="true"></i>
                </app-button>
              </ng-container>

              <ng-container *ngIf="viewState.canShowPlaceOrderButton && !viewState.isPlaceOrderButtonDisabled">
                <app-button color="primary" (click)="placeOrder()">
                  Place order <i class="pl-2 fa fa-arrow-right" aria-hidden="true"></i>
                </app-button>
              </ng-container>

              <app-button color="primary" *ngIf="viewState.canShowMarkAsDeliveredButton" (click)="setAsDelivered()">
                Mark as delivered <i class="pl-2 fa fa-arrow-right" aria-hidden="true"></i>
              </app-button>

              <app-button *ngIf="viewState.isOrderOwner" (click)="goToEditOrder()">
                Edit order <i class="pl-2 fa fa-cog" aria-hidden="true"></i>
              </app-button>
            </div>
          </div>
        </div>

        <app-order-entries-list [showOrderResponse]="orderResponse"
                                [viewState]="viewState"
                                [modifyOrderEntryState]="modifyOrderEntryState"
                                (refreshRequest)="onRefreshRequest()">
        </app-order-entries-list>
      </app-view-wrapper>
    </ng-container>
  </ng-container>
</ng-container>
