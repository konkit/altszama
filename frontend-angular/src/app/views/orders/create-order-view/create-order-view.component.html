<app-view-wrapper title="Create Order">
  <div *ngIf="fullRestaurantsList.length === 0">
    <h1 class="my-4">There are no restaurants, please create one first</h1>
  </div>

  <div *ngIf="fullRestaurantsList.length > 0">
    <mat-vertical-stepper [linear]="true" #stepper>
      <mat-step [stepControl]="this.orderForm.controls.restaurantId">
        <ng-template matStepLabel>Select restaurant</ng-template>

        <div class="py-4">
          <mat-form-field class="w-full">
            <input matInput [value]="restaurantsFilter" (input)="filterChanged($event)"
                   placeholder="Filter restaurants by name"/>
          </mat-form-field>

          <table mat-table [dataSource]="restaurantsTableDataSource" class="clickable-table">
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Restaurant Name</th>
              <td mat-cell *matCellDef="let element"> {{element.name}} </td>
            </ng-container>

            <tr mat-row *matRowDef="let row; columns: ['name'];"
                [ngClass]="{'selected': this.orderForm.controls.restaurantId.value === row.id}"
                (click)="this.orderForm.controls.restaurantId.setValue(row.id)"></tr>
          </table>

          <mat-paginator [pageSize]="5"
                         showFirstLastButtons
                         aria-label="Select page">
          </mat-paginator>

          <button mat-raised-button matStepperPrevious (click)="backToTodayOrders()">Back</button>
          <button mat-raised-button color="primary" matStepperNext>Next</button>
        </div>
      </mat-step>


      <mat-step>
        <ng-template matStepLabel>Fill details</ng-template>

        <div class="flex flex-row py-4">
          <div [formGroup]="orderForm" class="mr-20">
            <h3>Order time</h3>

            <mat-form-field>
              <input matInput
                     [formControl]="orderForm.controls.timeOfOrder"
                     placeholder="16:00"
                     label="Order time"
              />
              <mat-icon matSuffix>
                watch_later
              </mat-icon>
            </mat-form-field>
          </div>

          <div class="mr-20">
            <h3>Price modifiers</h3>
            <div>
              <mat-form-field>
                <mat-label>Price decrease (in percent)</mat-label>
                <input matInput [formControl]="orderForm.controls.deliveryData.controls.decreaseInPercent"/>
              </mat-form-field>
            </div>

            <div>
              <mat-form-field>
                <mat-label>Delivery cost (total)</mat-label>
                <input matInput [formControl]="orderForm.controls.deliveryData.controls.deliveryCostPerEverybody"/>
              </mat-form-field>
            </div>

            <div>
              <mat-form-field>
                <mat-label>Delivery cost (per dish)</mat-label>
                <input matInput [formControl]="orderForm.controls.deliveryData.controls.deliveryCostPerDish"/>
              </mat-form-field>
            </div>
          </div>

          <div>
            <h3>Payment</h3>

            <div class="pb-8">
              <mat-slide-toggle [formControl]="orderForm.controls.paymentData.controls.paymentByCash">
                Payment by cash
              </mat-slide-toggle>
            </div>

            <div class="pb-4">
              <mat-slide-toggle [formControl]="orderForm.controls.paymentData.controls.paymentByBankTransfer">
                Payment by bank transfer
              </mat-slide-toggle>
            </div>

            <div class="pb-4">
              <mat-form-field>
                <mat-label>Bank transfer number</mat-label>
                <input matInput [formControl]="orderForm.controls.paymentData.controls.bankTransferNumber"/>
              </mat-form-field>
            </div>

            <div class="pb-4">
              <mat-slide-toggle [formControl]="orderForm.controls.paymentData.controls.paymentByBlik">
                Payment by BLIK
              </mat-slide-toggle>
            </div>

            <div>
              <mat-form-field>
                <mat-label>BLIK phone number</mat-label>
                <input matInput [formControl]="orderForm.controls.paymentData.controls.blikPhoneNumber"/>
              </mat-form-field>
            </div>
          </div>

        </div>

        <button mat-raised-button matStepperPrevious>Back</button>
        <button mat-raised-button color="primary" (click)="submitForm($event)">Create</button>
      </mat-step>
    </mat-vertical-stepper>
  </div>
</app-view-wrapper>
